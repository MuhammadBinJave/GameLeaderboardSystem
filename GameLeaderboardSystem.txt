import java.util.*;

class Player {
    int id;
    String name;
    int score;

    Player(int id, String name, int score) {
        this.id = id;
        this.name = name;
        this.score = score;
    }
}

public class GameLeaderboardSystem {

    static ArrayList<Player> players = new ArrayList<>();
    static Stack<String> matchHistory = new Stack<>();
    static Scanner sc = new Scanner(System.in);

    public static void main(String[] args) {
        int choice;

        do {
            System.out.println("\n--- Game Leaderboard & Match History System ---");
            System.out.println("1. Add Player");
            System.out.println("2. Update Score");
            System.out.println("3. Show Leaderboard");
            System.out.println("4. Undo Last Match");
            System.out.println("5. Search Player by ID");
            System.out.println("6. Exit");
            System.out.print("Enter choice: ");
            choice = sc.nextInt();
            sc.nextLine();

            switch (choice) {
                case 1:
                    addPlayer();
                    break;
                case 2:
                    updateScore();
                    break;
                case 3:
                    showLeaderboard();
                    break;
                case 4:
                    undoLastMatch();
                    break;
                case 5:
                    searchPlayer();
                    break;
                case 6:
                    System.out.println("Exiting...");
                    break;
                default:
                    System.out.println("Invalid choice");
            }

        } while (choice != 6);
    }

    static void addPlayer() {
        System.out.print("Enter Player ID: ");
        int id = sc.nextInt();
        sc.nextLine();

        System.out.print("Enter Player Name: ");
        String name = sc.nextLine();

        System.out.print("Enter Player Score: ");
        int score = sc.nextInt();

        players.add(new Player(id, name, score));
        matchHistory.push("Added player: " + name);
        System.out.println("Player added successfully!");
    }

    static void updateScore() {
        System.out.print("Enter Player ID to update: ");
        int id = sc.nextInt();
        sc.nextLine();

        for (Player p : players) {
            if (p.id == id) {
                System.out.print("Enter new score: ");
                int newScore = sc.nextInt();
                sc.nextLine();
                matchHistory.push("Updated " + p.name + "'s score from " + p.score + " to " + newScore);
                p.score = newScore;
                System.out.println("Score updated successfully!");
                return;
            }
        }

        System.out.println("Player not found!");
    }

    static void showLeaderboard() {
        players.sort((a, b) -> b.score - a.score);
        System.out.println("\n--- Leaderboard ---");
        for (int i = 0; i < players.size(); i++) {
            Player p = players.get(i);
            System.out.println((i + 1) + ". ID: " + p.id + " Name: " + p.name + " Score: " + p.score);
        }
    }

    static void undoLastMatch() {
        if (matchHistory.isEmpty()) {
            System.out.println("No match history to undo!");
            return;
        }
        String last = matchHistory.pop();
        System.out.println("Undo: " + last);
    }

    static void searchPlayer() {
        players.sort(Comparator.comparingInt(p -> p.id));
        System.out.print("Enter Player ID to search: ");
        int target = sc.nextInt();
        int low = 0, high = players.size() - 1;

        while (low <= high) {
            int mid = (low + high) / 2;
            if (players.get(mid).id == target) {
                Player p = players.get(mid);
                System.out.println("Player Found: ID: " + p.id + " Name: " + p.name + " Score: " + p.score);
                return;
            }
            if (players.get(mid).id < target)
                low = mid + 1;
            else
                high = mid - 1;
        }

        System.out.println("Player not found!");
    }
}
